{% extends "site_base.html" %}
{% load i18n bootstrap_tags %}

{% block head_title %}Mail massiva{% endblock %}

{% block extra_style %}
{{ block.super }}
<style type="text/css">
    table th.centered { text-align: center; }
    table td.centered { text-align: center; }
    table thead th { background-color: #ccf9cc; }
</style>
{% if wizard %}{{ wizard.form.media }}{% endif %}
{% endblock %}

{% block body %}

<div class="page-header">
    <h1>Mail Massiva</h1>
</div>

<div class="row">

{% if perms.member.change_member %}
<div class="span12">

<table class="table table-striped table-bordered">
    <thead>
    <tr>
        <th>Ruolo</th>
        <th>Con E-mail</th>
        <th>Senza E-mail</th>
    </tr>
    </thead>
    <tbody>
    {% for role in roles %}
    <tr>
        <th>{{ role.name }}</th>
        <td>
            {% for member in role.get_members_with_mail %}
                {{ member.get_full_name }}
             {% if forloop.last %}{% else %} - {% endif %}
            {% endfor %}
        </td>
        <td>
            {% for member in role.get_members_without_mail %}
                {{ member.get_full_name }}
                {% for number in member.get_phone_numbers %}
                    {% if forloop.first %}({% endif %}
                    {{ number }}
                    {% if forloop.last %}){% else %}, {% endif %}
                {% endfor %}
                {% if forloop.last %}{% else %} - {% endif %}
            {% endfor %}
        </td>
    </tr>
    {% endfor %}
    </tbody>
</table>

<form action="" method="post">{% csrf_token %}
{{ wizard.management_form }}
{{ wizard.form|as_bootstrap }}
<div class="form-actions">
    <button name="wizard_goto_step" class="btn" type="submit" value="{{ wizard.steps.prev }}">{% trans "Previous" %}</button>
    <a href="mailto:{{ mail_recipient_short }}" class="btn"><i class="icon-envelope icon-white"></i> Outlook</a>
    <a href="mailto:{{ mail_recipient }}" class="btn btn-primary"><i class="icon-envelope icon-white"></i> E-Mail</a>
</div>
</form>

</div>
{% endif %}

</div>


{% endblock %}
